<% var user = user || null %>

<!DOCTYPE html>
<html>
<head>
  <%- include('head'); %>
  <link rel="stylesheet" href="/css/login.css">
</head>
<body>
  <%- include('header') %>
  <% if (!user) { %>
    <div id='login'>
      <p class="login-title">登入</p>
      <div class="login-line">
        <label>用户名</label><input type="text" id="login-account" maxlength="16">
      </div>
      <div class="login-line">
        <label>密码</label><input type="password" id="login-password" maxlength="16" value="">
      </div>
      <div class="login-line">
        <div class="login-btn" id="login-submit">登入</div>
        <div class="login-btn" id="login-reg">注册</div>
      </div>
      <p class="login-text"></p>
    </div>
    <script src="js/common/jquery-3.1.1.min.js"></script>
    <script>
      jQuery(function(){
        $('#login-submit').on('click', function(){
          $('.login-text').text('登入中...')
          $.ajax({
            url: 'ajax/login',
            data: {
              account: $('#login-account').val(),
              password: $('#login-password').val()
            },
            success: function(doc){
              switch (doc.state) {
                case 1:
                  $('.login-text').text('登入成功！ 2秒后自动转跳')
                  setTimeout(function(){
                    window.location = 'user'
                  }, 2000)
                  break;
                case 1001:
                  $('.login-text').text('用户名为空')
                  break;
                case 1002:
                  $('.login-text').text('密码为空')
                  break;
                case 1003:
                  $('.login-text').text('用户名不存在')
                  break;
                case 1004:
                  $('.login-text').text('密码错误')
                  break;
                case 1005:
                  $('.login-text').text('数据库错误')
                  break;
                default:
                  $('.login-text').text('未知错误')
                  break;
              }
            }
          })
        })
      })
    </script>

  <% } else { %>
    <div>
      喵，你进入了一个神秘的领域。
    </div>
  <% } %>






</body>
</html>