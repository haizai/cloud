!function(t){function e(n){if(i[n])return i[n].exports;var s=i[n]={exports:{},id:n,loaded:!1};return t[n].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var i={};return e.m=t,e.c=i,e.p="/public/",e(0)}([function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var s=i(1),a=n(s),r=i(2),o=n(r),l=i(9),u=n(l),c=function(t,e){if(e){var i=function(t){return document.getElementById(t)};i("pl00").addEventListener("click",function(e){e.target.blur(),t.scene.modPlayer("pl00")}),i("pl01").addEventListener("click",function(e){e.target.blur(),t.scene.modPlayer("pl01")}),i("speedRange").addEventListener("input",function(e){e.target.blur(),i("speedSpan").innerHTML=e.target.value,t.scene.modSpeed(+e.target.value)}),i("infinieFrameRange").addEventListener("input",function(e){e.target.blur(),i("infinieFrameSpan").innerHTML=e.target.value,t.scene.modInfinieFrame(+e.target.value)}),i("quickFrameRange").addEventListener("input",function(e){e.target.blur(),i("quickFrameSpan").innerHTML=e.target.value,t.scene.modQuickFrame(+e.target.value)})}},h={pl00_01:"img/pl00/pl00_01.png",pl00_02:"img/pl00/pl00_02.png",pl00_03:"img/pl00/pl00_03.png",pl00_04:"img/pl00/pl00_04.png",pl00_05:"img/pl00/pl00_05.png",pl00_06:"img/pl00/pl00_06.png",pl00_07:"img/pl00/pl00_07.png",pl00_08:"img/pl00/pl00_08.png",pl00_09:"img/pl00/pl00_09.png",pl00_10:"img/pl00/pl00_10.png",pl00_11:"img/pl00/pl00_11.png",pl00_12:"img/pl00/pl00_12.png",pl00_13:"img/pl00/pl00_13.png",pl00_14:"img/pl00/pl00_14.png",pl00_15:"img/pl00/pl00_15.png",pl00_16:"img/pl00/pl00_16.png",pl00_17:"img/pl00/pl00_17.png",pl00_18:"img/pl00/pl00_18.png",pl00_19:"img/pl00/pl00_19.png",pl00_20:"img/pl00/pl00_20.png",pl00_21:"img/pl00/pl00_21.png",pl00_22:"img/pl00/pl00_22.png",pl00_23:"img/pl00/pl00_23.png",pl00_24:"img/pl00/pl00_24.png",pl01_01:"img/pl01/pl01_01.png",pl01_02:"img/pl01/pl01_02.png",pl01_03:"img/pl01/pl01_03.png",pl01_04:"img/pl01/pl01_04.png",pl01_05:"img/pl01/pl01_05.png",pl01_06:"img/pl01/pl01_06.png",pl01_07:"img/pl01/pl01_07.png",pl01_08:"img/pl01/pl01_08.png",pl01_09:"img/pl01/pl01_09.png",pl01_10:"img/pl01/pl01_10.png",pl01_11:"img/pl01/pl01_11.png",pl01_12:"img/pl01/pl01_12.png",pl01_13:"img/pl01/pl01_13.png",pl01_14:"img/pl01/pl01_14.png",pl01_15:"img/pl01/pl01_15.png",pl01_16:"img/pl01/pl01_16.png",pl01_17:"img/pl01/pl01_17.png",pl01_18:"img/pl01/pl01_18.png",pl01_19:"img/pl01/pl01_19.png",pl01_20:"img/pl01/pl01_20.png",pl01_21:"img/pl01/pl01_21.png",pl01_22:"img/pl01/pl01_22.png",pl01_23:"img/pl01/pl01_23.png",pl01_24:"img/pl01/pl01_24.png"},p=a.default.instance(30,u.default,h,function(t){var e=new o.default(t);t.runWithScene(e)});c(p,!0),console.log(p)},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=function(){function t(e,n,s,a){var r=this;i(this,t),window.fps=e,this.config=n,this.images=s,this.textures={},this.runCallback=a,this.scene=null,this.actions={},this.endActions={},this.startActions={},this.keydowns={},this.canvas=document.querySelector("#id-canvas"),this.context=this.canvas.getContext("2d"),window.addEventListener("keydown",function(t){r.keydowns[t.keyCode]=!0,r.startActions[t.keyCode]&&r.startActions[t.keyCode].allow&&(r.startActions[t.keyCode].cb(),r.startActions[t.keyCode].allow=!1)}),window.addEventListener("keyup",function(t){r.keydowns[t.keyCode]=!1,r.endActions[t.keyCode]&&(r.endActions[t.keyCode](),r.startActions[t.keyCode]&&(r.startActions[t.keyCode].allow=!0))}),this.init()}return n(t,[{key:"drawImage",value:function(t){var e=this.textures[t.name];this.context.drawImage(e,t.x-t.w/2,t.y-t.h/2)}},{key:"registerAction",value:function(t,e,i,n){e&&(this.actions[t]=e),i&&(this.startActions[t]={cb:i,allow:!0}),n&&(this.endActions[t]=n)}},{key:"__start",value:function(){this.runCallback(this)}},{key:"runWithScene",value:function(t){var e=this;this.scene=t,setTimeout(function(){e.runloop()},1e3/window.fps)}},{key:"runloop",value:function(){for(var t=this,e=Object.keys(this.actions),i=0;i<e.length;i++){var n=e[i];this.keydowns[n]&&this.actions[n]()}this.update(),this.context.clearRect(0,0,this.canvas.width,this.canvas.heithisht),this.draw(),setTimeout(function(){t.runloop()},1e3/window.fps)}},{key:"update",value:function(){this.scene.update()}},{key:"draw",value:function(){this.scene.draw()}},{key:"init",value:function(){for(var t=this,e=0,i=Object.keys(t.images),n=function(){var n=i[s];a=t.images[n];var r=new Image;r.src=a,r.onload=function(){t.textures[n]=r,e++,console.log("load images",e,i.length),e==i.length&&(console.log("load images",t.images),t.__start())}},s=0;s<i.length;s++){var a;n()}}}],[{key:"instance",value:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return this.i=this.i||new(Function.prototype.bind.apply(this,[null].concat(e))),this.i}}]),t}();e.default=s},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=i(3),o=n(r),l=i(8),u=n(l),c=function(){function t(e){s(this,t),this.game=e,this.game.scene=this,this.eles=[],this.player=new o.default(this.game),this.addEle(this.player),this.registerPlayerAction()}return a(t,[{key:"registerPlayerAction",value:function(){var t=this;this.game.registerAction("37",function(){return t.player.onDirection("l")},null,function(){return t.player.offDirection("l")}),this.game.registerAction("39",function(){return t.player.onDirection("r")},null,function(){return t.player.offDirection("r")}),this.game.registerAction("38",function(){return t.player.onDirection("t")},null,function(){return t.player.offDirection("t")}),this.game.registerAction("40",function(){return t.player.onDirection("b")},null,function(){return t.player.offDirection("b")})}},{key:"addEle",value:function(t){this.eles.push(t)}},{key:"removeEle",value:function(t){this.eles.splice(this.eles.indexOf(t),1)}},{key:"drawEles",value:function(){var t=this;this.eles.forEach(function(e){t.game.drawImage(e)})}},{key:"modPlayer",value:function(t){if("pl00"==t){if("pl00"==this.player.player)return;this.removeEle(this.player),this.player=new o.default(this.game),this.addEle(this.player),this.registerPlayerAction()}else{if("pl01"==this.player.player)return;this.removeEle(this.player),this.player=new u.default(this.game),this.addEle(this.player),this.registerPlayerAction()}}},{key:"modSpeed",value:function(t){this.player.speed=t}},{key:"modInfinieFrame",value:function(t){this.player.anime.infinieFrame=t}},{key:"modQuickFrame",value:function(t){this.player.anime.quickFrame=t}},{key:"draw",value:function(){this.game.context.fillStyle="#554",this.game.context.fillRect(0,0,this.game.config.width,this.game.config.height),this.drawEles()}},{key:"update",value:function(){window.paused||this.eles.forEach(function(t){t.anime&&t.anime.update(),t.update&&t.update()})}}]),t}();e.default=c},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var o=i(4),l=n(o),u=function(t){function e(t){return s(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,"pl00"))}return r(e,t),e}(l.default);e.default=u},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=i(5),u=n(l),c=i(6),h=(n(c),i(7)),p=n(h),f=function(t){function e(t,i){s(this,e);var n=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i+"_01"));return n.x=200,n.y=500,n.speed=6,n.player=i,n.l=!1,n.r=!1,n.t=!1,n.b=!1,n.lf=null,n.tb=null,n.anime=new p.default(n,[i+"_01",i+"_02",i+"_03",i+"_04",i+"_05",i+"_06",i+"_07",i+"_08"],[i+"_09",i+"_10",i+"_11",i+"_12"],[i+"_13",i+"_14",i+"_15",i+"_16"],[i+"_17",i+"_18",i+"_19",i+"_20"],[i+"_21",i+"_22",i+"_23",i+"_24"]),n}return r(e,t),o(e,[{key:"move",value:function(t){switch(t){case"l":this.moveLeft();break;case"r":this.moveRight();break;case"t":this.moveTop();break;case"b":this.moveBottom()}}},{key:"moveLeft",value:function(){this.anime.moveLeft(),this.x>this.speed+this.w/2?this.x-=this.speed:this.x=this.w/2}},{key:"moveRight",value:function(){this.anime.moveRight(),this.x<this.game.config.width-this.w/2-this.speed?this.x+=this.speed:this.x=this.game.config.width-this.w/2}},{key:"moveTop",value:function(){this.y>this.speed+this.h/2?this.y-=this.speed:this.y=this.h/2}},{key:"moveBottom",value:function(){this.y<this.game.config.height-this.h/2-this.speed?this.y+=this.speed:this.y=this.game.config.height-this.h/2}},{key:"stay",value:function(){this.anime.stay()}},{key:"onDirection",value:function(t){switch(t){case"l":!this.l&&this.r&&(this.lr="l"),this.l=!0;break;case"r":!this.r&&this.l&&(this.lr="r"),this.r=!0;break;case"t":!this.t&&this.b&&(this.tb="t"),this.t=!0;break;case"b":!this.b&&this.t&&(this.tb="b"),this.b=!0}}},{key:"offDirection",value:function(t){switch(t){case"l":this.l=!1,this.lr=null;break;case"r":this.r=!1,this.lr=null;break;case"t":this.t=!1,this.tb=null;break;case"b":this.b=!1,this.tb=null}}},{key:"update",value:function(){this.lr?this.move(this.lr):this.l?this.move("l"):this.r?this.move("r"):this.stay(),this.tb?this.move(this.tb):this.t?this.move("t"):this.b&&this.move("b")}}]),e}(u.default);e.default=f},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function t(e,n){i(this,t),this.game=e,this.name=n,this.texture=e.textures[n],this.w=this.texture.width,this.h=this.texture.height,this.x=0,this.y=0};e.default=n},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=function(){function t(e,n,s){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"infinite",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;i(this,t),this.lnImage=n,this.game=e,this.changeNames(s),this.frameIndex=0,this.frameCount=a,this.nowCount=a,this.iteration=r,this.cb=o}return n(t,[{key:"update",value:function(){if(this.nowCount--,0==this.nowCount&&0!==this.iteration&&(this.nowCount=this.frameCount,this.frameIndex=(this.frameIndex+1)%this.frames.length,this.lnImage.image=this.frames[this.frameIndex],this.frameIndex==this.frames.length-1))switch(this.iteration){case"infinite":break;case 1:this.iteration=0,this.cb&&this.cb();break;default:this.iteration--}}},{key:"changeNames",value:function(t){var e=this;this.frameCount=5,this.frames=t.map(function(t){return e.game.images[t]})}}]),t}();e.default=s},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=i(6),o=(n(r),function(){function t(e,i,n,a,r,o){s(this,t),this.lnImage=e,this.stayImgs=i,this.stayToLeftImgs=n,this.leftImgs=a,this.stayToRightImgs=r,this.rightImgs=o,this.infinieFrame=3,this.quickFrame=1,this.frameCount=this.infinieFrame,this.nowCount=this.quickFrame,this.frameIndex=0,this.frames=this.stayImgs,this.stage="stay",this.iteration="infinite",this.nextFun=null}return a(t,[{key:"update",value:function(){this.nextFun&&(this.nextFun(),this.nextFun=null),this.nowCount--,0===this.nowCount&&(this.nowCount=this.frameCount,this.doAnime())}},{key:"doAnime",value:function(){if(this.frameIndex++,0!==this.iteration)if(this.frameIndex<this.frames.length)this.lnImage.name=this.frames[this.frameIndex];else switch(this.iteration){default:this.iteration--;case"infinite":this.frameIndex=0,this.lnImage.name=this.frames[this.frameIndex];break;case 1:this.end()}}},{key:"moveLeft",value:function(){var t=this;"stayToLeft"!==this.stage&&"left"!==this.stage&&(this.stage="stayToLeft",this.nextFun=function(){t.configAnime(t.stayToLeftImgs,1,t.quickFrame)})}},{key:"moveRight",value:function(){var t=this;"stayToRight"!==this.stage&&"right"!==this.stage&&(this.stage="stayToRight",this.nextFun=function(){t.configAnime(t.stayToRightImgs,1,t.quickFrame)})}},{key:"end",value:function(){var t=this;switch(this.stage){case"stayToLeft":this.stage="left",this.nextFun=function(){t.configAnime(t.leftImgs)};break;case"stayToRight":this.stage="right",this.nextFun=function(){t.configAnime(t.rightImgs)};break;case"leftToStay":case"rightToStay":this.stage="stay",this.nextFun=function(){t.configAnime(t.stayImgs)}}}},{key:"stay",value:function(){var t=this;switch(this.stage){case"left":this.stage="leftToStay",this.nextFun=function(){t.configAnime(t.stayToLeftImgs.slice().reverse(),1,t.quickFrame)};break;case"stayToLeft":this.stage="leftToStay",this.nextFun=function(){t.configAnime(t.stayToLeftImgs.slice(t.frameIndex).reverse(),1,t.quickFrame)};break;case"right":this.stage="rightToStay",this.nextFun=function(){t.configAnime(t.stayToRightImgs.slice().reverse(),1,t.quickFrame)};break;case"stayToRight":this.stage="rightToStay",this.nextFun=function(){t.configAnime(t.stayToRightImgs.slice(t.frameIndex).reverse(),1,t.quickFrame)}}}},{key:"configAnime",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"infinite",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.infinieFrame;this.frames=t,this.iteration=e,this.frameCount=i,this.frameIndex=-1}}]),t}());e.default=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var o=i(4),l=n(o),u=function(t){function e(t){return s(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,"pl01"))}return r(e,t),e}(l.default);e.default=u},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={width:400,height:600}}]);
//# sourceMappingURL=game.js.map